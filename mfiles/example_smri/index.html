
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/brain_icon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Structural MRI data - CCA/PLS Toolkit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.08040f6c.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#generate-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CCA/PLS Toolkit" class="md-header__button md-logo" aria-label="CCA/PLS Toolkit" data-md-component="logo">
      
  <img src="../../assets/brain_icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CCA/PLS Toolkit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Structural MRI data
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/MLNL/cca_pls_toolkit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    CCA_PLS_toolkit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CCA/PLS Toolkit" class="md-nav__button md-logo" aria-label="CCA/PLS Toolkit" data-md-component="logo">
      
  <img src="../../assets/brain_icon.png" alt="logo">

    </a>
    CCA/PLS Toolkit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/MLNL/cca_pls_toolkit/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    CCA_PLS_toolkit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../background/" class="md-nav__link">
        Background
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../analysis/" class="md-nav__link">
        Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../visualization/" class="md-nav__link">
        Visualization
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Defaults
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Defaults" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Defaults
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cfg/" class="md-nav__link">
        cfg
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../res/" class="md-nav__link">
        res
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Functions" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cfg_defaults/" class="md-nav__link">
        cfg_defaults
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cleanup_files/" class="md-nav__link">
        cleanup_files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../generate_data/" class="md-nav__link">
        generate_data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_paropt/" class="md-nav__link">
        plot_paropt
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_proj/" class="md-nav__link">
        plot_proj
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../plot_weight/" class="md-nav__link">
        plot_weight
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../res_defaults/" class="md-nav__link">
        res_defaults
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../set_path/" class="md-nav__link">
        set_path
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../update_dir/" class="md-nav__link">
        update_dir
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../example_simulation/" class="md-nav__link">
        Simulated data
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Structural MRI data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Structural MRI data
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#generate-data" class="md-nav__link">
    Generate data
  </a>
  
    <nav class="md-nav" aria-label="Generate data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-label-files" class="md-nav__link">
    Create label files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis" class="md-nav__link">
    Analysis
  </a>
  
    <nav class="md-nav" aria-label="Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-folder" class="md-nav__link">
    Project folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machine" class="md-nav__link">
    Machine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#framework" class="md-nav__link">
    Framework
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statistical-inference" class="md-nav__link">
    Statistical inference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-analysis" class="md-nav__link">
    Run analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization" class="md-nav__link">
    Visualization
  </a>
  
    <nav class="md-nav" aria-label="Visualization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plot-grid-search-results" class="md-nav__link">
    Plot grid search results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-projections" class="md-nav__link">
    Plot projections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-weights" class="md-nav__link">
    Plot weights
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../example_fmri/" class="md-nav__link">
        Functional MRI data
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../full_demo/" class="md-nav__link">
        Full Demo
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#generate-data" class="md-nav__link">
    Generate data
  </a>
  
    <nav class="md-nav" aria-label="Generate data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-label-files" class="md-nav__link">
    Create label files
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analysis" class="md-nav__link">
    Analysis
  </a>
  
    <nav class="md-nav" aria-label="Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-folder" class="md-nav__link">
    Project folder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#machine" class="md-nav__link">
    Machine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#framework" class="md-nav__link">
    Framework
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    Environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#statistical-inference" class="md-nav__link">
    Statistical inference
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-analysis" class="md-nav__link">
    Run analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization" class="md-nav__link">
    Visualization
  </a>
  
    <nav class="md-nav" aria-label="Visualization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plot-grid-search-results" class="md-nav__link">
    Plot grid search results
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-projections" class="md-nav__link">
    Plot projections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot-weights" class="md-nav__link">
    Plot weights
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/MLNL/cca_pls_toolkit/edit/master/docs/mfiles/example_smri.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


  <h1>Structural MRI data</h1>

<p><span style="font-size:2em;"><strong>example_smri</strong></span></p>
<p>This is a demo for simulated sMRI data. We will discuss step
by step how to generate data, run an analysis as well as how to visualize
the results. Copy and paste the code chunks into a function to create 
your own experiment or copy the function from the <code>examples</code> folder of 
the toolkit.</p>
<h2 id="generate-data">Generate data</h2>
<p>First, we generate the simulated data using the 
<a href="../generate_data"><code>generate_data</code></a> function of the toolkit. We 
will use 1000 examples, 120 features in the brain modality and 100 
features in the behavioural modality. We set the signal to be sparse with 
10% of the features in each modality that are relevant to capture the 
association across modalities. The noise parameter of the model is set to 
1. For further details on the generative model, see <a href="https://doi.org/10.1016/j.bpsc.2022.07.012">Mihalik et al. 2022</a>.</p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">%----- Generate data</span><span class="w"></span>

<span class="c">% Data folder</span><span class="w"></span>
<span class="n">data_dir</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fullfile</span><span class="p">(</span><span class="nb">fileparts</span><span class="p">(</span><span class="nb">mfilename</span><span class="p">(</span><span class="s">&#39;fullpath&#39;</span><span class="p">)),</span><span class="w"> </span><span class="s">&#39;example_smri&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;data&#39;</span><span class="p">);</span><span class="w"></span>

<span class="k">if</span><span class="w"> </span><span class="o">~</span><span class="nb">exist</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;X.mat&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;file&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="o">~</span><span class="nb">exist</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Y.mat&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;file&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="c">% Generate simulated sMRI data</span><span class="w"></span>
<span class="w">        </span><span class="p">[</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">wX</span><span class="p">,</span><span class="w"> </span><span class="n">wY</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">generate_data</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c">% Save simulated data and true model weights</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="o">~</span><span class="nb">isfolder</span><span class="p">(</span><span class="s">&#39;data_dir&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="nb">mkdir</span><span class="p">(</span><span class="n">data_dir</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">end</span><span class="w"></span>
<span class="w">        </span><span class="nb">save</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;X.mat&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;X&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="nb">save</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Y.mat&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;Y&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="nb">save</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;wX.mat&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;wX&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="nb">save</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;wY.mat&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;wY&#39;</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</code></pre></div>
<h3 id="create-label-files">Create label files</h3>
<p>As we use simulated sMRI and behavioural data, we need to 
create label files. For the brain features, we will use the AAL atlas to 
create 120 regions-level labels. For our behavioural label file, we will 
simply use indexes for <code>Label</code> and 2 domains as <code>Category</code>.</p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">% Add the AAL2 (https://www.gin.cnrs.fr/en/tools/aal/) and the BrainNet</span><span class="w"></span>
<span class="c">% Viewer (https://www.nitrc.org/projects/bnv/) toolboxes to the path </span><span class="w"></span>
<span class="n">set_path</span><span class="p">(</span><span class="s">&#39;aal&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;brainnet&#39;</span><span class="p">);</span><span class="w"></span>

<span class="c">% Create AAL labels for simulated sMRI data</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="o">~</span><span class="nb">exist</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LabelsX.csv&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;file&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">BrainNet_GenCoord</span><span class="p">(</span><span class="nb">which</span><span class="p">(</span><span class="s">&#39;AAL2.nii&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;AAL.txt&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">readtable</span><span class="p">(</span><span class="s">&#39;AAL.txt&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">nROI</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">size</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="n">T</span><span class="p">.</span><span class="n">Properties</span><span class="p">.</span><span class="n">VariableNames</span><span class="p">([</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="w"> </span><span class="mi">6</span><span class="p">])</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;X&#39;</span><span class="w"> </span><span class="s">&#39;Y&#39;</span><span class="w"> </span><span class="s">&#39;Z&#39;</span><span class="w"> </span><span class="s">&#39;Index&#39;</span><span class="p">};</span><span class="w"></span>
<span class="w">        </span><span class="n">T</span><span class="p">.</span><span class="n">Label</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">nROI</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="nb">writetable</span><span class="p">(</span><span class="n">T</span><span class="p">(:,[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="w"> </span><span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">]),</span><span class="w"> </span><span class="nb">fullfile</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LabelsX.csv&#39;</span><span class="p">));</span><span class="w"></span>
<span class="w">        </span><span class="n">delete</span><span class="w"> </span><span class="s">AAL.txt</span><span class="p">;</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>

<span class="c">% Create labels for fake behavioural data</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="o">~</span><span class="nb">exist</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LabelsY.csv&#39;</span><span class="p">),</span><span class="w"> </span><span class="s">&#39;file&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">table</span><span class="p">([</span><span class="mi">1</span><span class="p">:</span><span class="mi">100</span><span class="p">]</span><span class="o">&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="nb">repmat</span><span class="p">({</span><span class="s">&#39;Domain 1&#39;</span><span class="p">},</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="nb">repmat</span><span class="p">({</span><span class="s">&#39;Domain 2&#39;</span><span class="p">},</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)],</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="w">            </span><span class="s">&#39;VariableNames&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;Label&#39;</span><span class="w"> </span><span class="s">&#39;Category&#39;</span><span class="p">});</span><span class="w"></span>
<span class="w">        </span><span class="nb">writetable</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="nb">fullfile</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;LabelsY.csv&#39;</span><span class="p">));</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</code></pre></div>
<h2 id="analysis">Analysis</h2>
<p>First, run <code>set_path</code> to add the necessary paths of the toolkit 
to your MATLAB path.</p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">%----- Analysis</span><span class="w"></span>

<span class="c">% Set path for analysis</span><span class="w"></span>
<span class="n">set_path</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<h3 id="project-folder">Project folder</h3>
<p>Next, we specify the folder to our project. Since we will use the toolkit
to generate fake structural MRI data, we do not need to provide input data (<code>X.mat</code>
and <code>Y.mat</code>). Make sure to specify the correct path. We recommend to use a 
full path, but a relative path should also work.</p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">% Project folder</span><span class="w"></span>
<span class="n">cfg</span><span class="p">.</span><span class="n">dir</span><span class="p">.</span><span class="n">project</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fullfile</span><span class="p">(</span><span class="nb">fileparts</span><span class="p">(</span><span class="n">data_dir</span><span class="p">));</span><span class="w"></span>
</code></pre></div>
<h3 id="machine">Machine</h3>
<p>Now, we configure the CCA/PLS model we would like to use. We set 
<code>machine.name</code> to <code>rcca</code> for <a href="../../background/#regularized-cca-rcca">Regularized CCA</a>.
To select the best hyperparameter (L2 regularization for RCCA), we will use 
a generalizability (measured as average out-of-sample corretion on the 
validation sets) criterion. This is set by <code>machine.param.crit = 'correl'</code>.</p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">% Machine settings</span><span class="w"></span>
<span class="n">cfg</span><span class="p">.</span><span class="n">machine</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;rcca&#39;</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>For more information on the CCA/PLS models and the hyperparameter choices,
see <a href="../../cfg/#machine">here</a>.</p>
<h3 id="framework">Framework</h3>
<p>Next, we set the framework name to <code>holdout</code> and the number of outer data 
splits to 1 to perform a single holdout approach. The <code>frwork.flag</code> field 
defines a custom name for this analysis. Make sure to give it a name that 
will help you organize different analyses you might run on your data.</p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">% Framework settings</span><span class="w"></span>
<span class="n">cfg</span><span class="p">.</span><span class="n">frwork</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;holdout&#39;</span><span class="p">;</span><span class="w"></span>
<span class="n">cfg</span><span class="p">.</span><span class="n">frwork</span><span class="p">.</span><span class="n">split</span><span class="p">.</span><span class="n">nout</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>For further details on the framework choices, see <a href="../../cfg/#frwork">here</a>.</p>
<h3 id="environment">Environment</h3>
<p>Next, we set the computational environment for the toolkit. As our RCCA
implementation is computationally efficient, most of the times we can run
it locally on our computer.</p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">% Environment settings</span><span class="w"></span>
<span class="n">cfg</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="n">comp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;local&#39;</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>For further details on the environmental settings, see <a href="../../cfg/#env">here</a>.</p>
<h3 id="statistical-inference">Statistical inference</h3>
<p>Finally, we need to define how the significance testing is performed. 
For quicker results, we set the number of permutations to 100, however, 
we recommend using at least 1000 permutations in general. </p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">% Statistical inference settings</span><span class="w"></span>
<span class="n">cfg</span><span class="p">.</span><span class="n">stat</span><span class="p">.</span><span class="n">nperm</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>For further details on the statistical inference, see <a href="../../cfg/#stat">here</a>.</p>
<h3 id="run-analysis">Run analysis</h3>
<p>To run the analysis, we simply update our <code>cfg</code> structure to add all 
necessary default values that we did not explicitly define and then run 
the <code>main</code> function. After the analysis, we clean up all the duplicate
and intermediate files to save disc space.</p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">% Update cfg with defaults</span><span class="w"></span>
<span class="n">cfg</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cfg_defaults</span><span class="p">(</span><span class="n">cfg</span><span class="p">);</span><span class="w"></span>

<span class="c">% Run analysis</span><span class="w"></span>
<span class="n">main</span><span class="p">(</span><span class="n">cfg</span><span class="p">);</span><span class="w"></span>

<span class="c">% Clean up analysis files to save disc space</span><span class="w"></span>
<span class="n">cleanup_files</span><span class="p">(</span><span class="n">cfg</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<h2 id="visualization">Visualization</h2>
<p>Now that we have run our first analysis, let's plot some of the results. 
Before we can do any plotting, we need to make sure that we have called 
<code>set_path('plot')</code> to add the plotting folder. Then we load the <code>res</code>
structure.</p>
<p>In general, we advise you to plot your results on a local computer as it 
is often cumbersome and slow in a cluster environment. If you move your 
results from a cluster to a local computer, you need update the paths in 
your <code>cfg*.mat</code> and <code>res*.mat</code> files using <code>update_dir</code>. This should be 
called once the <code>res</code> structure is loaded either manually or by <code>res_defaults</code>.</p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">%----- Visualization</span><span class="w"></span>

<span class="c">% Set path for plotting and the BrainNet Viewer toolbox</span><span class="w"></span>
<span class="n">set_path</span><span class="p">(</span><span class="s">&#39;plot&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;brainnet&#39;</span><span class="p">);</span><span class="w"></span>

<span class="c">% Load res</span><span class="w"></span>
<span class="n">res</span><span class="p">.</span><span class="n">dir</span><span class="p">.</span><span class="n">frwork</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cfg</span><span class="p">.</span><span class="n">dir</span><span class="p">.</span><span class="n">frwork</span><span class="p">;</span><span class="w"></span>
<span class="n">res</span><span class="p">.</span><span class="n">frwork</span><span class="p">.</span><span class="n">level</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="n">res</span><span class="p">.</span><span class="n">gen</span><span class="p">.</span><span class="n">selectfile</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;none&#39;</span><span class="p">;</span><span class="w"></span>
<span class="n">res</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">res_defaults</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;load&#39;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<h3 id="plot-grid-search-results">Plot grid search results</h3>
<p>First, we plot the grid search results of the hyperparameter
optimization. As first argument, we need to pass the <code>res</code> structure. 
Then we specify the data modality as string. The last argument is a 
varargin to define an optional number of metrics. Each metric will be 
plotted as a function of the hyperparameter grid and in a separate
subplot. In this example, we plot the training (in-sample) and test 
(out-of-sample) correlations as  metrics.</p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="n">plot_paropt</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;trcorrel&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;correl&#39;</span><span class="p">},</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="s">&#39;gen.figure.Position&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">500</span><span class="w"> </span><span class="mi">600</span><span class="w"> </span><span class="mi">800</span><span class="w"> </span><span class="mi">400</span><span class="p">],</span><span class="w"> </span><span class="s">&#39;gen.axes.FontSize&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="s">&#39;gen.axes.XScale&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;log&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;gen.axes.YScale&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;log&#39;</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><img alt="demo_smri_grid" src="../../figures/example_smri_paropt.png" /></p>
<h3 id="plot-projections">Plot projections</h3>
<p>To plot the data projections (or latent variables) that has been 
learnt by the model, simply run <code>plot_proj</code>. As first argument, we need 
to pass the <code>res</code> structure. Then, we specify the data modalities as cell 
array and the level of associative effect. In this example, we plot the 
projections of <code>X</code> and <code>Y</code> for the first associative effect.
We set the fourth input parameter to 'osplit' so that the training and 
test data of the outer split will be used for the plot. The following 
argument defines the outer data split we want to use (in this demo, we 
have only one split). We use the second to last argument to specify the 
colour-coding of the data using the training and test data as groups 
(<code>teid</code>). Finally, we specify the low-level function that will plot the 
results. In this case it is <code>plot_proj_2d_group</code>. Please see the 
documentation of <a href="../mfiles/plot_proj/">plot_proj</a> for more details. </p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">% Plot data projections</span><span class="w"></span>
<span class="n">plot_proj</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&#39;X&#39;</span><span class="w"> </span><span class="s">&#39;Y&#39;</span><span class="p">},</span><span class="w"> </span><span class="n">res</span><span class="p">.</span><span class="n">frwork</span><span class="p">.</span><span class="n">level</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;osplit&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;training+test&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="s">&#39;2d_group&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;gen.axes.FontSize&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="s">&#39;gen.legend.FontSize&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;gen.legend.Location&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;NorthWest&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span><span class="c"> </span><span class="w"></span>
<span class="s">&#39;proj.scatter.SizeData&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">120</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;proj.scatter.MarkerEdgeColor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="s">&#39;proj.scatter.MarkerFaceColor&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">0.3</span><span class="w"> </span><span class="mf">0.3</span><span class="w"> </span><span class="mf">0.9</span><span class="p">;</span><span class="w"> </span><span class="mf">0.9</span><span class="w"> </span><span class="mf">0.3</span><span class="w"> </span><span class="mf">0.3</span><span class="p">]);</span><span class="w"></span>
</code></pre></div>
<p><img alt="demo_smri_proj" src="../../figures/example_smri_proj.png" /></p>
<h3 id="plot-weights">Plot weights</h3>
<p>Plotting model weights heavily depends on the kind of data that has been 
used in the analysis. In case of our fake structural MRI data, we will 
plot the weights as nodes on a glass brain. We will use only the top 20 
most positive and top 20 most negative weights for the figure. We set 
this by first sorting the weights by their sign (<code>roi.weight.sorttype = sign</code>)
then taking the top 20 from both ends (<code>roi.weight.numtop = 20</code>). In case 
of our fake behavioural data, we will plot the weights as a vertical bar 
plot, again using only the top 20 most positive and top 20 most negative
weights. As first argument, we need to pass the <code>res</code> function, in which
we define our custom processing for the weights. We also add the indexes of 
cerebellum (based on the label file) to the <code>res</code> settings as do not want 
to include cerebellum weights on the glass brain. Next, we specify the 
data modality and the type of the modality as strings. In this example, we use 
region-level brain and behavioural data, so we set these to <code>X</code> and <code>roi</code>
for one and <code>Y</code> and <code>behav</code> for the other. The following argument 
defines the outer data split we want to use. Finally, we specify 
the low-level function that will plot the results. In this example, it 
will be <code>plot_weight_brain_node</code> and <code>plot_weight_behav_vert</code>. Please 
see the documentation of <a href="../mfiles/plot_weight">plot_weight</a> for more details. </p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">% Plot ROI weights on a glass brain</span><span class="w"></span>
<span class="n">plot_weight</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;X&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;roi&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;brain_node&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="s">&#39;roi.weight.sorttype&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;sign&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;roi.weight.numtop&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="s">&#39;roi.out&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">9000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">[</span><span class="nb">reshape</span><span class="p">([</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">81</span><span class="p">;</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">82</span><span class="p">],</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="nb">reshape</span><span class="p">(</span><span class="mi">100</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">170</span><span class="p">,</span><span class="w"> </span><span class="p">[],</span><span class="w"> </span><span class="mi">1</span><span class="p">)]);</span><span class="w"></span>
</code></pre></div>
<p><img alt="demo_smri_wx" src="../../figures/example_smri_weight_brain.png" /></p>
<div class="highlight"><span class="filename">Matlab</span><pre><span></span><code><span class="c">% Plot behavioural weights as vertical bar plot</span><span class="w"></span>
<span class="n">plot_weight</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Y&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;behav&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;behav_vert&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="s">&#39;gen.axes.FontSize&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;gen.legend.FontSize&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="k">...</span><span class="w"></span>
<span class="s">&#39;behav.weight.sorttype&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;sign&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;behav.weight.numtop&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">);</span><span class="w"></span>
</code></pre></div>
<p><img alt="demo_smri_wy" src="../../figures/example_smri_weight_bar.png" /></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../example_simulation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Simulated data" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Simulated data
            </div>
          </div>
        </a>
      
      
        
        <a href="../example_fmri/" class="md-footer__link md-footer__link--next" aria-label="Next: Functional MRI data" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Functional MRI data
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>